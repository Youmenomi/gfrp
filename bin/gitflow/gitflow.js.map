{"version":3,"file":"gitflow.js","sources":["../../src/gitflow/index.ts"],"sourcesContent":["// import { Plugin } from 'release-it';\nconst { Plugin } = require('release-it');\n\n// const versionTransformer = (context) => (input) =>\n//   semver.valid(input)\n//     ? semver.gt(input, context.latestVersion)\n//       ? green(input)\n//       : red(input)\n//     : redBright(input);\n\nconst getIncrementChoices = (context) => {\n  console.log('[GitFlow Plugin] getIncrementChoices', context);\n  // const types = context.latestIsPreRelease ? t.latestIsPreRelease : context.isPreRelease ? t.preRelease : t.default;\n  // const choices = types.map(increment => ({\n  //   name: `${increment} (${semver.inc(context.latestVersion, increment, context.preReleaseId)})`,\n  //   value: increment\n  // }));\n  const otherChoice = {\n    name: 'Other, please specify...',\n    value: '1.2.3'\n  };\n  return [otherChoice];\n};\n\nconst prompts = {\n  incrementList: {\n    type: 'list',\n    message: () => 'Select or specify a new version:',\n    choices: (context) => getIncrementChoices(context),\n    pageSize: 9\n  }\n};\n\nexport default class GitFlow extends Plugin {\n  constructor(...args) {\n    console.log('[GitFlow Plugin] constructor', args);\n    super(...args);\n    this.registerPrompts(prompts);\n  }\n\n  getIncrementedVersion(options) {\n    console.log('[GitFlow Plugin] getIncrementedVersion', options);\n    return this.promptIncrementVersion(options);\n  }\n\n  promptIncrementVersion(options) {\n    return new Promise((resolve) => {\n      this.step({\n        prompt: 'incrementList',\n        task: resolve\n      });\n    });\n  }\n}\n"],"names":["Plugin","require","getIncrementChoices","context","console","log","otherChoice","name","value","prompts","incrementList","type","message","choices","pageSize","GitFlow","constructor","args","registerPrompts","getIncrementedVersion","options","promptIncrementVersion","Promise","resolve","step","prompt","task"],"mappings":";;AAAA;AACA,MAAM;EAAEA;IAAWC,OAAO,CAAC,YAAD,CAA1B;;;;;;;;AASA,MAAMC,mBAAmB,GAAIC,OAAD,IAAa;EACvCC,OAAO,CAACC,GAAR,CAAY,sCAAZ,EAAoDF,OAApD,EADuC;;;;;;QAOjCG,WAAW,GAAG;IAClBC,IAAI,EAAE,0BADY;IAElBC,KAAK,EAAE;GAFT;SAIO,CAACF,WAAD,CAAP;CAXF;;AAcA,MAAMG,OAAO,GAAG;EACdC,aAAa,EAAE;IACbC,IAAI,EAAE,MADO;IAEbC,OAAO,EAAE,MAAM,kCAFF;IAGbC,OAAO,EAAGV,OAAD,IAAaD,mBAAmB,CAACC,OAAD,CAH5B;IAIbW,QAAQ,EAAE;;CALd;AASA,AAAe,MAAMC,OAAN,SAAsBf,MAAtB,CAA6B;EAC1CgB,WAAW,CAAC,GAAGC,IAAJ,EAAU;IACnBb,OAAO,CAACC,GAAR,CAAY,8BAAZ,EAA4CY,IAA5C;UACM,GAAGA,IAAT;SACKC,eAAL,CAAqBT,OAArB;;;EAGFU,qBAAqB,CAACC,OAAD,EAAU;IAC7BhB,OAAO,CAACC,GAAR,CAAY,wCAAZ,EAAsDe,OAAtD;WACO,KAAKC,sBAAL,CAA4BD,OAA5B,CAAP;;;EAGFC,sBAAsB,CAACD,OAAD,EAAU;WACvB,IAAIE,OAAJ,CAAaC,OAAD,IAAa;WACzBC,IAAL,CAAU;QACRC,MAAM,EAAE,eADA;QAERC,IAAI,EAAEH;OAFR;KADK,CAAP;;;;;;;"}